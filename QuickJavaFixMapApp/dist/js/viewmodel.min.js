/*! P5-1-Neighborhood-Map-App 2016-02-14 */
var Venue=function(a){this.id=ko.observable(a.location.id),this.name=ko.observable(a.location.name),this.formatted_address=ko.observable(a.location.location.display_address[0]),this.distance=ko.observable(a.location.distance),this.image_url=ko.observable(a.location.image_url),this.rating_img_url=ko.observable(a.location.rating_img_url),this.rating=ko.observable(a.location.rating),this.snippet_text=ko.observable(a.location.snippet_text),this.yelpURL=ko.observable(a.location.mobile_url),this.marker=ko.observable(a.marker)},ViewModel=function(){var a=this;this.locations=ko.observableArray([]),this.markers=ko.observableArray([]),this.totalNumLocs=app.getLocations().length,this.inputVal=ko.observable(""),this.mapErrorDetails=ko.observable("Oops...Something went wrong with Google maps. Please refresh or try later and either accept or decline the geolocation request."),this.yelpErrorDetails=ko.observable("Oops...Something went wrong in contacting Yelp. Please refresh or try again at a later time.");var b=function(){for(var b=0;b<a.totalNumLocs;b++)a.locations.push(new Venue(app.getLocations()[b]))};a.totalNumLocs&&(b(),this.currentListMarker=ko.observable()),this.selectListMarker=function(b){a.currentListMarker(b),app.selectListMarker(a.currentListMarker())},this.sortedLocations=function(){return a.locations().sort(function(a,b){return a.distance()==b.distance()?0:a.distance()<b.distance()?-1:1})},this.filteredLocations=ko.computed(function(){return ko.utils.arrayFilter(a.sortedLocations(),function(b){return-1!==b.name().toLowerCase().indexOf(a.inputVal().toLowerCase())?(b.marker().setVisible(!0),!0):(b.marker().setVisible(!1),!1)})},this)};